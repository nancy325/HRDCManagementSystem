@model IEnumerable<HRDCManagementSystem.Models.ViewModels.TrainingReportViewModel>

<style>
    /* Clean table styling */
    .report-card {
        border-radius: 16px;
        overflow: hidden;
    }

    .report-header {
        padding: 15px 20px;
        border-bottom: 1px solid #e6e6e6;
        background: #f8f9fa;
    }

        .report-header h5 {
            margin: 0;
            font-weight: 600;
            color: #0d6efd;
        }

    .modern-table thead th {
        background: #f1f3f5;
        white-space: nowrap;
        font-size: 0.85rem;
        letter-spacing: 0.3px;
    }

    .modern-table tbody tr {
        transition: background 0.15s ease;
    }

        .modern-table tbody tr:hover {
            background: #f9fbff;
        }

    .result-pass {
        color: #198754;
        font-weight: 600;
    }

    .result-fail {
        color: #dc3545;
        font-weight: 600;
    }

    .result-other {
        color: #6c757d;
        font-weight: 600;
    }

    .table-cell {
        padding: 12px 10px !important;
    }
</style>

<div class="card shadow-sm border-0 report-card">

    <!-- Header -->
    <div class="report-header d-flex justify-content-between align-items-center">
        <h5><i class="bi bi-bar-chart-line me-2"></i>Training Report</h5>
    </div>

    <!-- Table -->
    <div class="table-responsive">
        <table class="table modern-table table-bordered align-middle mb-0">

            <thead class="text-center">
                <tr>
                    <th>Employee Name</th>
                    <th>Department</th>
                    <th>Email</th>
                    <th>Training</th>
                    <th>Start Date</th>
                    <th>End Date</th>
                    <th>From Time</th>
                    <th>To Time</th>
                    <th>Attendance %</th>
                    <th>Marks</th>
                    <th>Result</th>
                </tr>
            </thead>

            <tbody>
                @if (Model != null && Model.Any())
                {
                    foreach (var r in Model)
                    {
                        <tr>
                            <td class="table-cell">@r.EmployeeName</td>
                            <td class="table-cell">@r.Department</td>
                            <td class="table-cell">@r.Email</td>
                            <td class="table-cell">@r.TrainingName</td>
                            <td class="table-cell">@r.StartDate.ToString("dd/MM/yyyy")</td>
                            <td class="table-cell">@r.EndDate.ToString("dd/MM/yyyy")</td>
                            <td class="table-cell">@r.FromTime.ToString("HH:mm")</td>
                            <td class="table-cell">@r.ToTime.ToString("HH:mm")</td>
                            <td class="table-cell fw-bold">@r.AttendancePercent.ToString("0.##")%</td>
                            <td class="table-cell">@(r.Marks?.ToString() ?? "-")</td>

                            <td class="table-cell text-center
                                        @(r.ResultStatus == "Pass" ? "result-pass" :
                                                                  r.ResultStatus == "Fail" ? "result-fail" :
                                                                  "result-other")">
                        @r.ResultStatus
                    </td>
                </tr>
                                }
                }
                else
                {
                    <tr>
                        <td colspan="11" class="text-center text-muted py-4">
                            <i class="bi bi-info-circle me-2"></i>No records found
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    </div>
</div>

<script>
    // Export to CSV
    document.getElementById('btnExportCsv')?.addEventListener('click', function () {
        const trainingId = document.getElementById('currentTrainingId')?.value;

        if (!trainingId || trainingId === '' || trainingId === '0') {
            alert('Please select a training first.');
            return;
        }

        const fromDate = document.getElementById('fromDate')?.value || '';
        const toDate = document.getElementById('toDate')?.value || '';

        let url = `/AdminReport/ExportToCsv?trainingId=${trainingId}`;
        if (fromDate) url += `&fromDate=${fromDate}`;
        if (toDate) url += `&toDate=${toDate}`;

        window.location.href = url;
    });
</script>
