@model HRDCManagementSystem.Models.ViewModels.FeedbackSubmissionViewModel

@{
    ViewData["Title"] = "Submit Feedback";
}

<div class="container mt-4">
    <div class="row">
        <div class="col-12">
            <div class="card shadow">
                <div class="card-header bg-primary text-white">
                    <h5 class="mb-0">Submit Feedback: @Model.TrainingTitle</h5>
                </div>
                <div class="card-body">
                    <form asp-action="SaveFeedback" method="post">
                        <input type="hidden" asp-for="TrainingSysID" />
                        <input type="hidden" asp-for="TrainingRegSysID" />
                        <input type="hidden" asp-for="TrainingTitle" />
                        
                        <div class="alert alert-info mb-4">
                            <i class="bi bi-info-circle"></i> Your feedback is valuable! Please take a moment to share your thoughts about the training.
                        </div>
                        
                        @for (var i = 0; i < Model.Responses.Count; i++)
                        {
                            <div class="card mb-4 border-light">
                                <div class="card-body">
                                    <input type="hidden" asp-for="Responses[i].QuestionID" />
                                    <input type="hidden" asp-for="Responses[i].QuestionText" />
                                    <input type="hidden" asp-for="Responses[i].QuestionType" />
                                    
                                    <h6 class="card-title mb-3">@(i + 1). @Model.Responses[i].QuestionText</h6>
                                    
                                    @if (Model.Responses[i].QuestionType == "Rating")
                                    {
                                        <div class="rating-input mb-2">
                                            <div class="form-group">
                                                <div class="rating">
                                                    @for (int star = 5; star >= 1; star--)
                                                    {
                                                        <input type="radio" asp-for="Responses[i].RatingValue" value="@star" id="star-@i-@star" />
                                                        <label for="star-@i-@star">
                                                            <i class="bi bi-star-fill"></i>
                                                        </label>
                                                    }
                                                </div>
                                                <span class="rating-value ms-2">(Select a rating)</span>
                                            </div>
                                        </div>
                                    }
                                    else
                                    {
                                        <div class="form-group">
                                            <textarea class="form-control" asp-for="Responses[i].ResponseText" rows="3" placeholder="Enter your response here..."></textarea>
                                        </div>
                                    }
                                </div>
                            </div>
                        }
                        
                        <div class="d-flex justify-content-between mt-4">
                            <a asp-action="Index" class="btn btn-secondary">Cancel</a>
                            <button type="submit" class="btn btn-primary">Submit Feedback</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
    .rating {
        display: flex;
        flex-direction: row-reverse;
        justify-content: flex-end;
    }
    
    .rating input {
        display: none;
    }
    
    .rating label {
        cursor: pointer;
        width: 40px;
        height: 40px;
        margin: 0;
        padding: 5px;
        font-size: 25px;
        color: #ddd;
    }
    
    .rating label:hover,
    .rating label:hover ~ label,
    .rating input:checked ~ label {
        color: #ffb400;
    }
</style>

@section Scripts {
    <script>
        $(document).ready(function() {
            $('.rating input').change(function() {
                var value = $(this).val();
                $(this).closest('.form-group').find('.rating-value').text(value + ' stars');
            });
        });
    </script>
}